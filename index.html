<!DOCTYPE html>
<html>
<head>
  <title>JS Carpentry Real-Time Dashboard</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', { packages: ['corechart'] });
    google.charts.setOnLoadCallback(drawAllCharts);

    function drawAllCharts() {
      const base = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vStLYy-cTvUYzFwdJi3MxQkCa0Lw_RPJBZQf1u7SmFnYcHtHrBRMhRJtYqrkh8JpxmZvImSwk4xvDWx/gviz/tq?sheet=Draft&headers=1&tq=';

      const charts = [
        { query: 'SELECT C, D', title: 'Metric D', id: 'chart1' },
        { query: 'SELECT C, E', title: 'Metric E', id: 'chart2' },
        { query: 'SELECT C, F', title: 'Metric F', id: 'chart3' },
        { query: 'SELECT C, G', title: 'Metric G', id: 'chart4' },
        { query: 'SELECT C, H', title: 'Metric H', id: 'chart5' }
      ];

      charts.forEach(({ query, title, id }) => {
        const fullUrl = base + encodeURIComponent(query);
        const queryObj = new google.visualization.Query(fullUrl);
        queryObj.send(response => {
          if (response.isError()) {
            document.getElementById(id).innerHTML = `<b>Error loading chart:</b><br>${response.getMessage()}`;
            return;
          }
          const data = response.getDataTable();
          const chart = new google.visualization.ColumnChart(document.getElementById(id));
          chart.draw(data, {
            title,
            hAxis: { title: 'Name' },
            vAxis: { title: 'Value' },
            chartArea: { width: '75%' },
            legend: { position: 'none' }
          });
        });
      });

      setTimeout(drawAllCharts, 60000);
    }
  </script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      text-align: center;
      padding: 20px;
    }
    h2 {
      margin-bottom: 30px;
    }
    .chart-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
    }
    .chart-box {
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      width: 500px;
      height: 400px;
    }
  </style>
</head>
<body>
  <h2>ðŸ“Š JS Carpentry Real-Time Dashboard</h2>
  <div class="chart-grid">
    <div class="chart-box" id="chart1">Loading...</div>
    <div class="chart-box" id="chart2">Loading...</div>
    <div class="chart-box" id="chart3">Loading...</div>
    <div class="chart-box" id="chart4">Loading...</div>
    <div class="chart-box" id="chart5">Loading...</div>
  </div>
</body>
</html>
